#!/bin/sh

. ./config

rm -rf "$FORMATS_COMPILED_DIR"
mkdir -p "$FORMATS_COMPILED_DIR"
"$COMPILER_DIR/jvm/target/universal/kaitai-struct-compiler-0.9-SNAPSHOT/bin/kaitai-struct-compiler" -- \
	--verbose all -t all -d "$FORMATS_COMPILED_DIR" \
	--import-path "$FORMATS_REPO_DIR" \
	--import-path "$FORMATS_KSY_DIR/ks_path" \
	--java-package io.kaitai.struct.testformats \
	--php-namespace 'Kaitai\Struct\Tests' \
	--go-package test_formats \
	--nim-module "$NIM_RUNTIME_DIR/kaitai_struct_nim_runtime" \
	"$FORMATS_KSY_DIR"/*.ksy || :
